# ATAC-Seq Snakemake Workflow

## ATAC-seq Methods

This workflow describes the ATAC-seq analysis process using two replicates of paired-end human data. The steps are organized as follows:

### 1. Quality Control

1. **Initial Quality Control:**
   - Use **FastQC** (v0.12.1) to assess the quality of the raw fastq files.

2. **Trimming:**
   - Trim the reads using **Trimmomatic** (v0.39) to remove low-quality bases and adapters.

### 2. Alignment

1. **Aligning Reads:**
   - Align the trimmed reads to the reference genome using **Bowtie2** (v2.5.3) with the `-X 2000` flag to specify the maximum fragment length.

2. **Sorting and Filtering:**
   - Sort the aligned reads using **Samtools sort** (v1.19.2).
   - Remove reads aligned to mitochondrial DNA using **Samtools view** (v1.19.2). This involves filtering the BAM files with grep and resorting them.

### 3. Read Shifting

- Shift the reads due to the tagmentation process using **Deeptools'** (v3.5.4) `alignmentSieve` command.

### 4. Secondary Quality Control

- Visualize the fragmentation distribution sizes using **ATACSeqQC** (v1.26.0) in an R script.

### 5. Peak Calling

1. **Calling Peaks:**
   - Perform peak calling using **MACS** (v3.0.1) with default parameters.

2. **Peak Overlapping:**
   - Overlay peaks from each replicate using **Bedtools** (v2.31.1) `intersect` command.
   - Generate a blacklist file to avoid false positives and re-run **Bedtools intersect**.

### 6. Peak Annotation and Visualization

1. **Annotating Peaks:**
   - Annotate peaks using **Homer** (v4.11) with the `annotatePeaks.pl` command.

2. **Motif Analysis:**
   - Identify motif patterns in open chromatin using **Homer's findMotifsGenome.pl**.

3. **Visualization:**
   - Generate graphs of replicate signal coverage near TSS and TES sites using **Deeptools**.
   - Use **ATACSeqQC** to produce a fragment length distribution plot.

### 7. Deliverables

- **Fragment Length Distribution Plot:**
  - Generated by **ATACSeqQC**.
- **Alignment Table:**
  - Created after using **Samtools view**, showing alignments before and after filtering mitochondrial DNA.
- **Signal Coverage Plot:**
  - Produced using **Deeptools' plotProfile** command.
- **Reproducible Peaks:**
  - Generated by **Homer** and **Bedtools**.
- **Motif Analysis Files:**
  - Provided by **Homer's findMotifsGenome**.
- **Gene Enrichment Analysis:**
  - Conducted via an R script or a tool like GREAT.
- **Chromatin Accessibility Proportions:**
  - Displayed using an R script showing the proportion of regions with accessible chromatin identified as peaks.

This workflow ensures comprehensive quality control, alignment, peak calling, annotation, and visualization for ATAC-seq data, resulting in reliable and interpretable results.
